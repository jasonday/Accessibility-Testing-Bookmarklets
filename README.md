# Accessibility testing bookmarklets that work with the Shadow DOM
Often taken from other bookmarklets and then heavily altering for my use cases


## Bookmarklets
- aName - Shows the various pieces for accessible name calculation; includes state, role, element, etc.
```
javascript:(function(){"use strict";function WTFocus(){p();p();const e="font-weight:bold;color:#99f170;background:#333;display:inline-block;padding:3px;%22,t=%22color:pink;background:#333;padding:3px;%22,n=document.createElement(%22div%22),o='%3Cspan%20aria-hidden=%22true%22%3E%F0%9F%91%89%F0%9F%8F%BD%3C/span%3E%3Cspan%20class=%22visually-hidden%22%3EAccessible%20name%20provided%20by%3C/span%3E%20',a='%3Cspan%20aria-hidden=%22true%22%3E%F0%9F%9A%A8%3C/span%3E%20%3Cspan%20class=%22visually-hidden%22%3EWarning%3C/span%3E';let%20i=%22Accessible%20name:%20%22,r=%22%22,l=!1,s=!1;function%20c(e,t,n){t=t.split(%22%3C%22).join(%22&lt;%22).split(%22%3E%22).join(%22&gt;%22),r+='%3Cli%20role=%22listitem%22%3E%3Cspan%20style=%22'+n+'%22%3E',l&&(r+=o),s&&(r+=a),r+=e+%22%3C/span%3E&nbsp;%22+t+%22%3C/li%3E\n%22,t=t.replace(%22&lt;%22,%22%3C%22).replace(%22&gt;%22,%22%3E%22)}function%20d(){const%20e=document.createElement(%22button%22);e.textContent=%22Close%20(Esc)%22,e.setAttribute(%22type%22,%22button%22),e.setAttribute(%22class%22,%22panel-btn%22),e.addEventListener(%22click%22,(()=%3E{u()}));const%20t=document.getElementById(%22WTFocusPanelContent%22);t.appendChild(e);const%20n=document.createElement(%22a%22);n.textContent=%22Download%20summary%20(S)%22,n.setAttribute(%22href%22,%22data:text/plain;charset=utf-8,%22+encodeURIComponent(function(){const%20e=f(document);let%20t=%22IMPORTANT%20DISCLAIMER!\n\nThis%20text%20file%20is%20a%20*very%20approximate%20representation*%20\nof%20what%20this%20page%20may%20be%20like%20for%20screen%20reader%20users:\n\n%22;return%20e.forEach((e=%3E{const{name:n}=b(e),o=m(e);let%20a=%22N/A%22;if(e.hasAttribute(%22aria-describedby%22)){const%20t=e.getAttribute(%22aria-describedby%22).split(%22%20%22),n=e.getRootNode();a=t.map((e=%3E{const%20t=n.querySelector(%60#${e}%60);return%20t?t.textContent:%22%22})).join(%22%20%22)}t+=%60Accessible%20Name:%20${n},%20Role:%20${o},%20Description:%20${a}\n%60})),t}())),n.setAttribute(%22download%22,%22summary.txt%22),t.appendChild(n)}function%20u(){document.querySelector(%22#WTFocusPanel%22)&&document.querySelector(%22#WTFocusPanel%22).remove(),document.querySelector(%22#panelStyles%22)&&document.querySelector(%22#panelStyles%22).remove(),document.querySelector(%22#focusStyles%22)&&document.querySelector(%22#focusStyles%22).remove(),document.removeEventListener(%22focusin%22,y)}function%20p(e=document){const%20t=e.activeElement;if(!t)return%20null;if(t.shadowRoot){return%20p(t.shadowRoot)||t}return%20t}function%20b(e){if(e.hasAttribute(%22aria-label%22))return{name:e.getAttribute(%22aria-label%22),source:%22aria-label%22};if(e.hasAttribute(%22aria-labelledby%22)){const%20t=e.getAttribute(%22aria-labelledby%22).split(%22%20%22),n=e.getRootNode(),o=t.map((e=%3E{const%20t=n.querySelector(%60#${e}%60);return%20t?t.textContent:%22%22})).join(%22%20%22);if(o)return{name:o,source:%22aria-labelledby%22}}const%20t=e.closest(%22label%22);if(t)return{name:t.textContent.trim(),source:%22%3Clabel%3E%20text%22};if(e.id){const%20t=e.getRootNode().querySelector(%60label[for=%22${e.id}%22]%60);if(t)return{name:t.textContent.trim(),source:%22%3Clabel%3E%20text%22}}return%20e.textContent.trim()?{name:e.textContent.trim(),source:%22Inner%20text%20content%22}:e.hasAttribute(%22title%22)?{name:e.getAttribute(%22title%22),source:%22title%20attribute%22}:{name:%22%22,source:%22N/A%22}}function%20m(e){let%20t=e.getAttribute(%22role%22),n=e.tagName.toLowerCase();if(t)return%20t;if(%22button%22===n)return%22button%22;if(%22a%22===n)return%22link%22;if(%22input%22===n){let%20t=e.getAttribute(%22type%22)?e.getAttribute(%22type%22).toLowerCase():%22text%22;return[%22button%22,%22image%22,%22reset%22,%22submit%22].includes(t)?%22button%22:%22checkbox%22===t||%22radio%22===t?t:%22textbox%22}return[%22select%22,%22textarea%22].includes(n)?%22textbox%22:%22generic%22}function%20f(e){const%20t=[...e.querySelectorAll('a[href],button,select,input:not([type=%22hidden%22]),textarea,summary,area,[tabindex]:not(#WTFocusPanel):not([tabindex^=%22-1%22]),[contenteditable]:not([contenteditable=%22false%22])')];return%20e.querySelectorAll(%22*%22).forEach((e=%3E{e.shadowRoot&&t.push(...f(e.shadowRoot))})),t}function%20y(o){let%20a=o.target;setTimeout((()=%3E{const%20o=p();o&&o!==a&&(a=o),a.classList.add(%22WTFocusTempFocusStyle%22),r=%22%22;const%20l=a.tagName.toLowerCase();let%20u=%22%3C%22+l+%22%3E%22;a.getAttribute(%22role%22)&&(u=%22%3C%22+l+'%20role=%22'+a.getAttribute(%22role%22)+'%22%3E');const{name:f,source:y}=b(a);%22%22===f?(s=!0,n.classList.add(%22error%22),c(i+%22No%20accessible%20name!%22,%22%22,t),c(%22Accessible%20Name%20Source:%20N/A%22,%22%22,t)):(n.classList.remove(%22error%22),c(i,f,e),c(%22Accessible%20Name%20Source:%20%22,y,e)),a.hasAttribute(%22data-dupe%22)&&(n.classList.add(%22warning%22),c(%22Duplicate%20warning!%22,%22Another%20element%20has%20the%20same%20accessible%20name%22,t)),s=!1;const%20h=function(e){const%20t={%22aria-busy%22:%22busy%22,%22aria-checked%22:%22checked%22,%22aria-current%22:%22current%22,%22aria-disabled%22:%22disabled%22,%22aria-expanded%22:%22expanded%22,%22aria-grabbed%22:%22grabbed%22,%22aria-hidden%22:%22hidden%22,%22aria-invalid%22:%22invalid%22,%22aria-pressed%22:%22pressed%22,%22aria-selected%22:%22selected%22,%22aria-haspopup%22:%22haspopup%22,%22aria-readonly%22:%22readonly%22,%22aria-required%22:%22required%22,%22aria-modal%22:%22modal%22,%22aria-multiline%22:%22multiline%22,%22aria-multiselectable%22:%22multiselectable%22,disabled:%22disabled%22,required:%22required%22,readonly:%22readonly%22,checked:%22checked%22,selected:%22selected%22,hidden:%22hidden%22,open:%22open%22,multiple:%22multiple%22,autofocus:%22autofocus%22,draggable:%22draggable%22,contenteditable:%22contenteditable%22,spellcheck:%22spellcheck%22};let%20n=[e];const%20o=e.getRootNode();o&&o.host&&n.push(o.host);const%20a=e.closest(%22:defined%22);a&&a!==e&&n.push(a);const%20i=new%20Set;return%22radio%22!==e.type&&%22checkbox%22!==e.type||e.checked&&i.add(%22checked%22),n.forEach((n=%3E{for(const[e,o]of%20Object.entries(t))if(n.hasAttribute(e)){const%20t=n.getAttribute(e);%22false%22!==t&&null!==t&&i.add(o)}n!==e&&n.tagName&&n.tagName.includes(%22-%22)&&(!0===n.checked||n.hasAttribute(%22checked%22))&&i.add(%22checked%22)})),Array.from(i).join(%22%20%22)}(a);h&&c(%22State:%20%22,h,e);if(c(%22Role:%20%22,m(a),e),a.getAttribute(%22aria-describedby%22)){const%20t=a.getAttribute(%22aria-describedby%22).split(%22%20%22),n=a.getRootNode();c(%22Accessible%20Description:%20%22,t.map((e=%3E{const%20t=n.querySelector(%60#${e}%60);return%20t?t.textContent:%22%22})).join(%22%20%22),e)}else%20c(%22Accessible%20Description:%20%22,%22N/A%22,e);c(%22HTML%20Element:%20%22,u,e);document.getElementById(%22WTFocusPanelContent%22).innerHTML='%3Cul%20role=%22list%22%3E'+r+%22%3C/ul%3E%22,d()}),0)}u(),function(e){const%20t=document.createElement(%22style%22);t.setAttribute(%22type%22,%22text/css%22),t.setAttribute(%22id%22,%22focusStyles%22),t.textContent=%22#WTFocusPanel.error%20{background:darkred;}%20#WTFocusPanel.warning%20{background:#CC3300;}%20#WTFocusPanel[hidden]%20{display:none;}%20#WTFocusPanel%20*%20{text-align:left;%20pointer-events:%20auto;}%20#WTFocusPanel%20{border:2px%20solid%20#fff;z-index:1000;text-shadow:none;font-family:sans-serif;display:block;text-align:left;position:%20fixed;z-index:10000;background:%20black;padding:%2020px%2020px;width:%22+e+%22px;font-size:16px;bottom:20px;right:20px;%20pointer-events:%20none;}%20#WTFocusPanel%20button%20{font-weight:bold;background:none;color:#fff;padding:3px%2010px;font-size:14px;border:1px%20solid%20#fff;display:inline-block;margin:10px%201em%20-10px%200;}%20#WTFocusPanel%20ul,#WTFocusPanel%20li%20{margin:0;padding:0;list-style:none}%20#WTFocusPanel%20li%20{margin:3px%200;background:#fff!important;color:#333!important;padding:2px}%20#WTFocusPanel%20details%20summary%20{color:white}%20#WTFocusPanel%20a[download]{display:block;margin:0.5em%200;color:#fff;text-decoration:underline;border:none;padding:0;}%22,document.querySelector(%22head%22).appendChild(t)}(400),function(){n.setAttribute(%22id%22,%22WTFocusPanel%22),n.setAttribute(%22aria-live%22,%22polite%22),n.setAttribute(%22tabindex%22,%22-1%22),n.setAttribute(%22role%22,%22region%22),n.setAttribute(%22aria-label%22,%22Accessibility%20properties%20panel%22);const%20e=document.createElement(%22div%22);e.setAttribute(%22id%22,%22WTFocusPanelHeader%22),e.style.cursor=%22move%22,e.style.padding=%2210px%22,e.style.backgroundColor=%22#333%22,e.style.color=%22white%22,e.textContent=%22WTFocus%20Panel%20(Drag%20Me)%22,n.appendChild(e);const%20t=document.createElement(%22div%22);t.setAttribute(%22id%22,%22WTFocusPanelContent%22),n.appendChild(t),document.querySelector(%22body%22).appendChild(n),window.addEventListener(%22keyup%22,(e=%3E{%22Escape%22===e.key&&document.querySelector(%22#WTFocusPanel%22)&&u(),%22s%22===e.key.toLowerCase()&&document.querySelector(%22#WTFocusPanel%22)&&document.querySelector(%22#WTFocusPanel%20a[download]%22).click()})),function(e){var%20t=0,n=0,o=0,a=0;document.getElementById(e.id+%22Header%22)?document.getElementById(e.id+%22Header%22).onmousedown=i:e.onmousedown=i;function%20i(e){(e=e||window.event).preventDefault(),o=e.clientX,a=e.clientY,document.onmouseup=l,document.onmousemove=r}function%20r(i){(i=i||window.event).preventDefault(),t=o-i.clientX,n=a-i.clientY,o=i.clientX,a=i.clientY,e.style.top=e.offsetTop-n+%22px%22,e.style.left=e.offsetLeft-t+%22px%22}function%20l(){document.onmouseup=null,document.onmousemove=null}}(n)}(),function(){const%20e=document.createElement(%22style%22);e.setAttribute(%22type%22,%22text/css%22),e.setAttribute(%22id%22,%22panelStyles%22),e.textContent=%22.WTFocusTempFocusStyle:focus%20{outline:7px%20solid%20black!important;outline-offset:7px!important;overflow:visible;}%20.visually-hidden%20{clip-path:%20inset(100%);clip:%20rect(1px,%201px,%201px,%201px);height:%201px;overflow:%20hidden;position:%20absolute;white-space:%20nowrap;width:%201px;}%22,document.querySelector(%22body%22).appendChild(e)}(),function(){const%20e=f(document),t=new%20Map;e.forEach((e=%3E{const{name:n}=b(e);n&&(t.has(n)?t.get(n).push(e):t.set(n,[e]))})),t.forEach(((e,t)=%3E{e.length%3E1&&e.forEach((e=%3Ee.setAttribute(%22data-dupe%22,%22true%22)))}))}(),document.addEventListener(%22focusin%22,y);const%20h=p();h&&y({target:h})}WTFocus();}());
```
- 
